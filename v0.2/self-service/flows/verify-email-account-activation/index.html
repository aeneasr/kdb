<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-71865250-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="ORY Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Email and Phone Verification and Account Activation | ORY Kratos</title><meta data-react-helmet="true" name="docsearch:version" content="v0.2"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Email and Phone Verification and Account Activation | ORY Kratos"><meta data-react-helmet="true" name="description" content="ORY Kratos allows users to verify their out-of-band (email, telephone number,"><meta data-react-helmet="true" property="og:description" content="ORY Kratos allows users to verify their out-of-band (email, telephone number,"><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/v0.2/self-service/flows/verify-email-account-activation"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/v0.2/self-service/flows/verify-email-account-activation"><link rel="stylesheet" href="/kratos/docs/styles.9e1fc63f.css">
<link rel="preload" href="/kratos/docs/styles.47fe7342.js" as="script">
<link rel="preload" href="/kratos/docs/runtime~main.25132285.js" as="script">
<link rel="preload" href="/kratos/docs/main.ad3de72d.js" as="script">
<link rel="preload" href="/kratos/docs/2.3f0cafd9.js" as="script">
<link rel="preload" href="/kratos/docs/3.9748f2ba.js" as="script">
<link rel="preload" href="/kratos/docs/1be78505.d928f7bc.js" as="script">
<link rel="preload" href="/kratos/docs/eb6fb697.9e49424f.js" as="script">
<link rel="preload" href="/kratos/docs/255.5a2f44ed.js" as="script">
<link rel="preload" href="/kratos/docs/254.7bfb09c2.js" as="script">
<link rel="preload" href="/kratos/docs/589d5674.af1ba59e.js" as="script">
<link rel="preload" href="/kratos/docs/17896441.b979b995.js" as="script">
<link rel="preload" href="/kratos/docs/2681ed6d.a3794aef.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/kratos/docs/">Docs</a><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ecosystem</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat</a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/kratos/docs/versions">v0.4</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/">Docs</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="menu__link">Ecosystem</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="menu__link">Forum</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Chat</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/versions">v0.4</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/install">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/identity-user-model">Identity Data Model</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Identity Credentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials/username-email-password">Username / Email &amp; Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials/openid-connect-oidc-oauth2">Social Sign In, OpenID Connect, and OAuth2</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/federation">Federation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Self Service</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/index">Before you start reading</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Flows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/user-login-user-registration">User Login and User Registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/user-logout">User Logout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/user-settings-profile-management">User Settings and Profile Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/self-service/flows/2fa-mfa-multi-factor-authentication">MFA / 2FA</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Strategies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/username-email-password">Username or Email and Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/user-settings-profile">User Profile</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Hooks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/hooks/index">Hooks</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/zero-trust-iap-proxy-identity-access-proxy">Zero Trust with IAP Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/multi-tenancy-multitenant">Multitenancy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/high-availability-ha">High Availability</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/html-forms">HTML Form Parser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/api">REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/debug/csrf">Common Cookie and CSRF Pitfalls</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/sdk/index">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/further-reading/comparison">Comparison</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Hydra</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/hydra/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for ORY Kratos <strong>vv0.2</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/kratos/docs/self-service/flows/verify-email-account-activation">latest version</a></strong> (v0.4).</div></div><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: v0.2</span></div><header><h1 class="docTitle_1Lrw">Email and Phone Verification and Account Activation</h1></header><div class="markdown"><p>ORY Kratos allows users to verify their out-of-band (email, telephone number,
...) communication channels. Verification can be initiated</p><ul><li>after registration or by performing a verification flow;</li><li>manually by the user.</li></ul><p>Currently, ORY Kratos only supports verification of email addresses. Before
sending out a verification E-Mail, ORY Kratos will check if the email address is
already known. Depending on the result, one of the two flows will be executed:</p><ul><li>Unknown email address: An email is sent to the address informing the recipient
that someone tried to verify this email address but that it is not known by
the system:<img alt="Verification email for unknown address" src="/kratos/docs/img/docs/email-verify-unknown.png"></li><li>Known email address: An email which includes a verification link is sent to
the address:<img alt="Verification email for known address" src="/kratos/docs/img/docs/email-verify-known.png"></li></ul><p>This prevents Account Enumeration Attacks at is is not possible for a threat
agent to determine if an account exists or not based on the verification flow.</p><p>The emails are using templates that can be customised as explained in
<a href="/kratos/docs/v0.2/concepts/email-sms#templates">Customizing E-Mail Templates</a>. The
template IDs are:</p><ul><li>Unknown email address: <code>verify_invalid</code></li><li>Known email address: <code>verify_valid</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="account-activation"></a>Account Activation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#account-activation" title="Direct link to heading">#</a></h2><p>Using this feature implements the so-called &quot;account activation&quot; with the
difference that ORY Kratos does not provide a feature that prevents sign in into
accounts without verified addresses. The reason being that verification is
proving that the user controls the given address, but it is not an
authentication mechanism.</p><p>You may however chose to limit what an identity without verified addresses is
able to do in your application logic or API Gateways.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-email-verification"></a>Setting Email Verification<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-email-verification" title="Direct link to heading">#</a></h2><p>You must define at least one Identity Traits field as a verification field. You
can do so by defining the following section in your Identity Traits JSON Schema:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">path/to/identity.traits.schema.json</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // This could also be an array or any other field name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    email: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;string&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      format: &#x27;email&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;ory.sh/kratos&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        verification: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          // Currently, only email is supported</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          via: &#x27;email&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>You can also combine this with the password strategy login identifier.</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">path/to/identity.traits.schema.json</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // This could also be an array or any other field name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    email: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;string&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      format: &#x27;email&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;ory.sh/kratos&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        credentials: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          password: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            identifier: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        verification: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          // Currently, only email is supported</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          via: &#x27;email&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>That way, the field <code>email</code> (or any field you define with these properties) will
serve as both the login identifier as well as a verifiable email address.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="verify-email-on-user-registration"></a>Verify Email on User Registration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#verify-email-on-user-registration" title="Direct link to heading">#</a></h3><p>To send an email after user registration, add the following sections to your ORY
Kratos config file:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">path/to/kratos.config.yml</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># required</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">urls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Similar to login_ui or profile_ui, this points to the user interface where the verificaiton</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># user interface is implemented.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># For more information on this endpoint please head over to the next section</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">verify_ui</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">kratos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ui/verify</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">selfservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">registration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">after</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">hooks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ....</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">hook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> verify </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This sends the verification email after successful registration</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ....</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="self-service-request-or-resend-verification-link-for-browser-applications"></a>Self-Service Request or Resend Verification Link for Browser Applications<a aria-hidden="true" tabindex="-1" class="hash-link" href="#self-service-request-or-resend-verification-link-for-browser-applications" title="Direct link to heading">#</a></h2><p>A user might want to resend a verification link because the link expired or did
not arrive in the inbox.</p><p>The flow implementing this feature uses the already established
<a href="/kratos/docs/v0.2/self-service/flows/index#network-flows-for-browsers">Network Flows for Browsers</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="server-side-browser-applications"></a>Server-Side Browser Applications<a aria-hidden="true" tabindex="-1" class="hash-link" href="#server-side-browser-applications" title="Direct link to heading">#</a></h3><p>You can find an exemplary implementation for this flow on GitHub:</p><ul><li><a href="https://github.com/ory/kratos-selfservice-ui-node/blob/master/src/routes/verify.ts" target="_blank" rel="noopener noreferrer">Verification HTTP Route</a></li><li><a href="https://github.com/ory/kratos-selfservice-ui-node/blob/master/views/verify.hbs" target="_blank" rel="noopener noreferrer">Verification UI</a></li></ul><p>The <a href="/kratos/docs/v0.2/self-service/flows/index#network-flows-for-browsers">Network Flows for Browsers</a> works as
follows for Email Verification:</p><ol><li>An initial HTTP Request is made to
<code>/self-service/browser/flows/verification/:via</code>. Currently, only <code>email</code> is
supported as <code>:via</code>.</li><li>ORY Kratos redirects the browser to the URL set in <code>urls.verify_ui</code> and
appends the <code>request</code> URL Query Parameter (e.g.
<code>https://example.org/verify?request=abcde</code>).</li><li>The Endpoint at <code>/profile</code> makes a HTTP GET Request to
<code>https://ory-kratos-admin.example-org.vpc/self-service/browser/flows/requests/verification?request=abcde</code>
and fetches Verification Request JSON Payload that represent the individual
fields that can be updated.</li><li>The user fills out the form and sends a HTTP POST request to
<code>https://example.org/.ory/kratos/public/self-service/browser/flows/verification/:via/complete?request=abcde</code>.
Depending on whether the address is known or not, a <code>verify_valid</code> or
<code>verify_invalid</code> message will be sent to the given address.</li></ol><p>An exemplary payload for a verification request looks as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;9c3e945c-096a-42ec-8617-caecda9e9263&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;expires_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2020-02-18T16:11:25.3112038Z&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;issued_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2020-02-18T15:11:25.3112824Z&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;request_url&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://127.0.0.1:4455/self-service/browser/flows/verification/email&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;form&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;action&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/verification/email/complete?request=9c3e945c-096a-42ec-8617-caecda9e9263&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;method&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;POST&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;fields&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;csrf_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hidden&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;required&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fMusJj65BxNtrog/DYryN4sZmuLA85WkbAh4yP9pT1lAQTIAPTVGJTmmLL66Y0HEbIpKEU5gTr5qJoRXHsBoSw==&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;to_verify&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;required&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;via&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;success&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="client-side-browser-applications"></a>Client-Side Browser Applications<a aria-hidden="true" tabindex="-1" class="hash-link" href="#client-side-browser-applications" title="Direct link to heading">#</a></h3><p>Because Client-Side Browser Applications do not have access to ORY Kratos&#x27; Admin
API, they must use the ORY Kratos Public API instead. The flow for a Client-Side
Browser Application is almost the exact same as the one for Server-Side
Applications, with the small difference that
<code>https://example.org/.ory/kratos/public/self-service/browser/flows/requests/verification?request=abcde</code>
would be called via AJAX instead of making a request to
<code>https://ory-kratos-admin.example-org.vpc/self-service/browser/flows/requests/verification?request=abcde</code>.</p><blockquote><p>To prevent brute force, guessing, session injection, and other attacks, it is
required that cookies are working for this endpoint. The cookie set in the
initial HTTP request made to
<code>https://example.org/.ory/kratos/public/self-service/browser/flows/verification/:via</code>
MUST be set and available when calling this endpoint!</p><p>When making AJAX requests from JavaScript, make sure to set
<code>{ withCredentials: true }</code> (name and layout may vary between libraries).</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="email-verification-for-api-clients"></a>Email Verification for API Clients<a aria-hidden="true" tabindex="-1" class="hash-link" href="#email-verification-for-api-clients" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/versioned_docs/version-v0.2/self-service/flows/verify-email-account-activation.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-05-04T15:18:18.000Z" class="docLastUpdatedAt_217_">5/4/2020</time> by <strong>aeneasr</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/v0.2/self-service/flows/user-facing-errors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« User-Facing Errors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/v0.2/self-service/flows/2fa-mfa-multi-factor-authentication"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MFA / 2FA Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#account-activation" class="table-of-contents__link">Account Activation</a></li><li><a href="#setting-email-verification" class="table-of-contents__link">Setting Email Verification</a><ul><li><a href="#verify-email-on-user-registration" class="table-of-contents__link">Verify Email on User Registration</a></li></ul></li><li><a href="#self-service-request-or-resend-verification-link-for-browser-applications" class="table-of-contents__link">Self-Service Request or Resend Verification Link for Browser Applications</a><ul><li><a href="#server-side-browser-applications" class="table-of-contents__link">Server-Side Browser Applications</a></li><li><a href="#client-side-browser-applications" class="table-of-contents__link">Client-Side Browser Applications</a></li></ul></li><li><a href="#email-verification-for-api-clients" class="table-of-contents__link">Email Verification for API Clients</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 ORY GmbH</div></div></div><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>document.querySelectorAll(".tabs .tabs-nav .nav-item a").forEach((function(t){t.addEventListener("click",(function(e){return e.preventDefault(),t.closest(".tabs-nav").querySelectorAll(".nav-item a").forEach((function(t){t.classList.remove("active")})),t.closest(".tabs").querySelectorAll(".tab-content .tab-pane").forEach((function(t){t.classList.remove("active")})),t.classList.add("active"),document.getElementById(t.href.split("#")[1]).classList.add("active"),!1}))}))</script></footer></div>
<script src="/kratos/docs/styles.47fe7342.js"></script>
<script src="/kratos/docs/runtime~main.25132285.js"></script>
<script src="/kratos/docs/main.ad3de72d.js"></script>
<script src="/kratos/docs/2.3f0cafd9.js"></script>
<script src="/kratos/docs/3.9748f2ba.js"></script>
<script src="/kratos/docs/1be78505.d928f7bc.js"></script>
<script src="/kratos/docs/eb6fb697.9e49424f.js"></script>
<script src="/kratos/docs/255.5a2f44ed.js"></script>
<script src="/kratos/docs/254.7bfb09c2.js"></script>
<script src="/kratos/docs/589d5674.af1ba59e.js"></script>
<script src="/kratos/docs/17896441.b979b995.js"></script>
<script src="/kratos/docs/2681ed6d.a3794aef.js"></script>
</body>
</html>